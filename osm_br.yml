name: OpenStreetMap e Brezhoneg
description: 'A general-purpose OpenStreetMap mapnik style, focused on minored langages, in CartoCSS'
attribution: 'CC-BY-SA OSM-BZH'
scale: 1
metatile: 2
bounds: &world
  - -180
  - -85
  - 180
  - 85
center:
  - -2.96
  - 48.03
  - 8
format: 'png'
interactivity: false
minzoom: 4
maxzoom: 18
srs: "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over"


_parts:
  # default values used by layers
  extents: &extents
    extent: *world
    srs-name: "3857"
    srs: "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over"
    class: ''
    status: 'on'

  extents84: &extents84
    extent: *world
    srs-name: "WGS84"
    srs: "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"

  osm2pgsql: &osm2pgsql
    type: "postgis"
    dbname: "osm"
    key_field: ""
    geometry_field: "way"
    extent: "-20037508,-20037508,20037508,20037508"
    host: db.openstreetmap.world
    user: osmbr
    password: m4d31nbr31zh
    asynchronous_request: 'true'
    max_async_connection: '4'


# stylesheets
Stylesheet:
  - palette.mss
  - base.mss
  - landcover.mss
  - admin.mss
  - roads.mss
  - labels.mss


# the layers
Layer:

  - id: land_low
    geometry: polygon
    <<: *extents
    Datasource:
      file: /data/styles/data/simplified-land-polygons-complete-3857/simplified_land_polygons.shp
      type: shape
    properties:
      maxzoom: 10


  - id: land_high
    geometry: polygon
    <<: *extents
    Datasource:
      file: /data/styles/data/land-polygons-split-3857/land_polygons.shp
      type: shape


  - id: big_forest
    geometry: polygon
    <<: *extents
    Datasource:
      <<: *osm2pgsql
      table: |-
        (SELECT
          osm_id, way, way_area AS area
        FROM
          planet_osm_polygon
        WHERE
          landuse = 'forest' AND way_area > 5000000
        ) AS big_forest
    properties:
      #polygon-simplify: 10
      #polygon-simplify-algorithm: douglas-peucker
      minzoom: 6
      maxzoom: 9


  - id: landcover_gen0
    geometry: polygon
    <<: *extents
    Datasource:
      <<: *osm2pgsql
      table: |-
        (SELECT
          osm_id, way, way_area AS area, COALESCE(landuse, leisure, "natural", highway, amenity, tourism) AS type
        FROM
          planet_osm_polygon
        WHERE
          way_area > 100000
        ) AS landcover_gen0
    properties:
      #polygon-simplify: 10
      #polygon-simplify-algorithm: douglas-peucker
      minzoom: 9
      maxzoom: 10


  - id: landcover_gen1
    geometry: polygon
    <<: *extents
    Datasource:
      <<: *osm2pgsql
      table: |-
        (SELECT
          osm_id, way, way_area AS area, COALESCE(landuse, leisure, "natural", highway, amenity, tourism) AS type
        FROM
          planet_osm_polygon
        WHERE
          way_area > 10000
        ) AS landcover_gen1
    properties:
      #polygon-simplify: 10
      #polygon-simplify-algorithm: douglas-peucker
      minzoom: 11
      maxzoom: 12


  - id: landcover
    geometry: polygon
    <<: *extents
    Datasource:
      <<: *osm2pgsql
      table: |-
        (SELECT
          osm_id, way, way_area AS area, COALESCE(landuse, leisure, "natural", highway, amenity, tourism) AS type
        FROM
          planet_osm_polygon
        ) AS landcover
    properties:
      #polygon-simplify: 10
      #polygon-simplify-algorithm: douglas-peucker
      minzoom: 12


  - id: aeroway
    geometry: polygon
    <<: *extents
    Datasource:
      <<: *osm2pgsql
      table: |-
        (SELECT
          osm_id, way, aeroway AS type
        FROM
          planet_osm_line
        WHERE
          aeroway IN ('apron', 'runway', 'taxiway')
        ) AS aeroway
    properties:
      minzoom: 10







